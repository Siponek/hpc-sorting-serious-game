@startuml http-sse-architecture
!theme plain
skinparam backgroundColor white
skinparam componentStyle rectangle
skinparam defaultFontName Arial

title HTTP/SSE Relay Architecture

package "Web Browsers" {
    component "Client 1\n(Host)" as C1 #LightBlue
    component "Client 2" as C2 #LightGreen
    component "Client 3" as C3 #LightGreen
    component "Client N" as CN #LightGreen
}

package "Server Infrastructure" {
    component "Relay Server\n(Python/aiohttp)" as RS #Orange {
        component "Lobby Manager" as LM
        component "SSE Broadcaster" as SSE
        component "Message Router" as MR
    }
}

database "In-Memory\nGame State" as GS #LightYellow

' HTTP POST connections (client to server)
C1 -[#Blue]-> RS : HTTP POST\n/api/lobby/*
C2 -[#Blue]-> RS : HTTP POST\n/api/lobby/*
C3 -[#Blue]-> RS : HTTP POST\n/api/lobby/*
CN -[#Blue]-> RS : HTTP POST\n/api/lobby/*

' SSE connections (server to client)
RS -[#Green]-> C1 : SSE Stream\n/api/lobby/events
RS -[#Green]-> C2 : SSE Stream\n/api/lobby/events
RS -[#Green]-> C3 : SSE Stream\n/api/lobby/events
RS -[#Green]-> CN : SSE Stream\n/api/lobby/events

RS --> GS : Store/Retrieve

note right of RS
  **Star Topology**
  All traffic routes through
  the relay server.

  No direct P2P connections.
end note

note bottom of C1
  Host manages
  game authority
end note

legend right
  |= Color |= Direction |
  | <#Blue> | Client -> Server (HTTP POST) |
  | <#Green> | Server -> Client (SSE) |
endlegend

@enduml
